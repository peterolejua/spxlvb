% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cv.spxlvb.R
\name{cv.spxlvb.fit}
\alias{cv.spxlvb.fit}
\title{Cross-validation and Final Model Fitting for spxlvb}
\usage{
cv.spxlvb.fit(
  k = 5,
  X,
  Y,
  mu_0 = NULL,
  omega_0 = NULL,
  c_pi_0 = NULL,
  d_pi_0 = NULL,
  tau_e = NULL,
  update_order = NULL,
  mu_alpha = NULL,
  alpha_prior_precision_grid = c(0, 10^(3:7)),
  b_prior_precision = rep(1, ncol(X)),
  standardize = TRUE,
  intercept = TRUE,
  max_iter = 100L,
  tol = 1e-05,
  seed = 12376,
  verbose = TRUE,
  parallel = TRUE
)
}
\arguments{
\item{k}{Integer, the number of folds for cross-validation. Must be at least 3.}

\item{X}{A numeric design matrix of dimension \eqn{n \times p}.}

\item{Y}{A numeric response vector of length \eqn{n}.}

\item{mu_0}{Optional numeric vector of length \eqn{p}. Initial variational means.}

\item{omega_0}{Optional numeric vector of length \eqn{p}. Initial variational probabilities.}

\item{c_pi_0}{Optional numeric. Prior shape1 parameter for \eqn{\pi}.}

\item{d_pi_0}{Optional numeric. Prior shape2 parameter for \eqn{\pi}.}

\item{tau_e}{Optional numeric. Initial precision of errors.}

\item{update_order}{Optional integer vector specifying the coordinate update sequence (0-indexed for C++).}

\item{mu_alpha}{Optional numeric vector of length \eqn{p+1}. Prior means for the expansion parameters.}

\item{alpha_prior_precision_grid}{A numeric vector of values to cross-validate over.
Defaults to \code{c(0, 10^(3:7))}.}

\item{b_prior_precision}{Numeric. Initial prior precision for the slab component. Defaults to 400.}

\item{standardize}{Logical. Should the design matrix be standardized? Defaults to TRUE.}

\item{intercept}{Logical. Should an intercept be included in the model? Defaults to TRUE.}

\item{max_iter}{Integer. Maximum number of iterations for each model fit.}

\item{tol}{Numeric. Convergence tolerance for the Variational Bayes algorithm.}

\item{seed}{Integer. Seed for reproducibility of data splitting.}

\item{verbose}{Logical. If TRUE, progress messages are printed to the console.}

\item{parallel}{Logical. If TRUE, execution is performed in parallel using the
currently registered backend (e.g., via \code{doParallel}).}
}
\value{
The final fitted \code{spxlvb} model object based on the full dataset.
If the final fit fails, the cross-validation results are returned with a warning.
}
\description{
Performs k-fold cross-validation to determine the optimal
\code{alpha_prior_precision} and then fits a final \code{spxlvb} model
to the full dataset using the identified optimal hyperparameter.
}
\details{
This function orchestrates the cross-validation process and the final model fit.
It first identifies initial values for the full dataset, uses \code{cv.spxlvb} to find
the optimal hyperparameter, and finally fits the model to the complete dataset.
}
\seealso{
\code{\link{cv.spxlvb}}, \code{\link{spxlvb}}
}
