% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cv.spxlvb.fit.R
\name{cv.spxlvb.fit}
\alias{cv.spxlvb.fit}
\title{Cross-validation and Final Model Fitting for spxlvb}
\usage{
cv.spxlvb.fit(
  k = 5,
  X,
  Y,
  mu = NULL,
  omega = NULL,
  c_pi = NULL,
  d_pi = NULL,
  tau_e = NULL,
  update_order = NULL,
  mu_alpha = rep(1, ncol(X)),
  tau_alpha = c(0, 10^(3:7)),
  tau_b = rep(400, ncol(X)),
  intercept = FALSE,
  max_iter = 100L,
  tol = 1e-05,
  seed = 12376,
  verbose = TRUE
)
}
\arguments{
\item{k}{Integer, the number of folds to use for cross-validation. Must be greater than 2.}

\item{X}{A design matrix.}

\item{Y}{A response vector.}

\item{mu}{Initial variational mean (posterior expectation of beta_j | s_j = 1).
If NULL, initialized automatically by \code{get.initials}.}

\item{omega}{Initial variational probability (posterior expectation of s_j).
If NULL, initialized automatically by \code{get.initials}.}

\item{c_pi}{Prior parameter for pi (beta distribution shape1).
If NULL, initialized automatically by \code{get.initials}.}

\item{d_pi}{Prior parameter for pi (beta distribution shape2).
If NULL, initialized automatically by \code{get.initials}.}

\item{tau_e}{Initial precision of errors.
If NULL, initialized automatically by \code{get.initials}.}

\item{update_order}{A numeric vector specifying the order of updates for coefficients.
If NULL, initialized automatically by \code{get.initials}.}

\item{mu_alpha}{Prior mean for alpha. Default is mu_alpha_j = 1.}

\item{tau_alpha}{A numeric vector of \code{tau_alpha} values to cross-validate over.
Must have at least two values.}

\item{tau_b}{Initial precision for beta_j (when s_j = 1). Default is a tau_b_j = 400.}

\item{intercept}{Logical, indicating whether an intercept term should be included in the model.}

\item{max_iter}{Maximum number of outer loop iterations for both CV fits and the final fit.}

\item{tol}{Convergence tolerance for both CV fits and the final fit.}

\item{seed}{Seed for reproducibility of data splitting and \code{glmnet} initials.}

\item{verbose}{Logical, if TRUE, prints progress messages during cross-validation.}
}
\value{
The final fitted \code{spxlvb} model, which is a list containing the approximate
posterior parameters and convergence information for the full dataset using the
optimal \code{tau_alpha} determined by cross-validation.
}
\description{
This function performs k-fold cross-validation to determine the optimal
\code{tau_alpha} parameter for the \code{spxlvb} model, and then fits a final \code{spxlvb} model
to the full dataset using this optimal \code{tau_alpha}. Initial values for the final
model are also derived from the full dataset.
}
\details{
This function orchestrates the cross-validation process and the final model fit.
It first gets initial values for the full dataset, then uses \code{cv.spxlvb} to find
the \code{tau_alpha} that minimizes cross-validation error, and finally calls \code{spxlvb}
on the complete dataset with the chosen \code{tau_alpha}.
}
\seealso{
\code{\link{cv.spxlvb}}, \code{\link{spxlvb}}
}
