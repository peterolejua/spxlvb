% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cv.spxlvb.R
\name{cv.spxlvb.fit}
\alias{cv.spxlvb.fit}
\title{Cross-validation and Final Model Fitting for spxlvb}
\usage{
cv.spxlvb.fit(
  k = 5,
  X,
  Y,
  mu_0 = NULL,
  omega_0 = NULL,
  c_pi_0 = NULL,
  d_pi_0 = NULL,
  tau_e = NULL,
  update_order = NULL,
  mu_alpha = NULL,
  alpha_prior_precision_grid = c(0, 10^(3:7)),
  b_prior_precision_grid = NULL,
  b_prior_precision = rep(1, ncol(X)),
  standardize = TRUE,
  intercept = TRUE,
  max_iter = 100L,
  tol = 1e-05,
  seed = 12376,
  verbose = TRUE,
  parallel = TRUE,
  save_history = FALSE
)
}
\arguments{
\item{k}{Integer, the number of folds for cross-validation. Must be at least 3.}

\item{X}{A numeric design matrix of dimension \eqn{n \times p}.}

\item{Y}{A numeric response vector of length \eqn{n}.}

\item{mu_0}{Optional numeric vector of length \eqn{p}. Initial variational means.}

\item{omega_0}{Optional numeric vector of length \eqn{p}. Initial variational probabilities.}

\item{c_pi_0}{Optional numeric. Prior shape1 parameter for \eqn{\pi}.}

\item{d_pi_0}{Optional numeric. Prior shape2 parameter for \eqn{\pi}.}

\item{tau_e}{Optional numeric. Initial precision of errors.}

\item{update_order}{Optional integer vector specifying the coordinate update sequence (0-indexed for C++).}

\item{mu_alpha}{Optional numeric vector of length \eqn{p+1}. Prior means for the expansion parameters.}

\item{alpha_prior_precision_grid}{A numeric vector of values to cross-validate over.
Defaults to \code{c(0, 10^(3:7))}.}

\item{b_prior_precision_grid}{Optional numeric vector of scalar slab prior
precisions to cross-validate over. When \code{NULL} (default), the scalar
\code{b_prior_precision} is used for every fit (1D search over
\code{alpha_prior_precision} only). When non-\code{NULL}, a 2D grid
search is performed over all combinations of
\code{alpha_prior_precision_grid} and \code{b_prior_precision_grid}.
Each grid value is expanded to a constant vector of length \eqn{p}.}

\item{b_prior_precision}{Numeric vector of length \eqn{p}.
Coordinate-specific slab prior precisions
(see \code{\link{spxlvb}} for details). Used only when
\code{b_prior_precision_grid} is \code{NULL}.
Defaults to a vector of ones of length \eqn{p} (determined
automatically from \code{X}).}

\item{standardize}{Logical. Should the design matrix be standardized? Defaults to TRUE.}

\item{intercept}{Logical. Should an intercept be included in the model? Defaults to TRUE.}

\item{max_iter}{Integer. Maximum number of iterations for each model fit.}

\item{tol}{Numeric. Convergence tolerance for the Variational Bayes algorithm.}

\item{seed}{Integer. Seed for reproducibility of data splitting.}

\item{verbose}{Logical. If TRUE, progress messages are printed to the console.}

\item{parallel}{Logical. If TRUE, execution is performed in parallel using the
currently registered backend (e.g., via \code{doParallel}).}

\item{save_history}{Logical. If TRUE, the final refit stores per-iteration
parameter histories. Default is FALSE to save memory in simulation studies.}
}
\value{
A list containing the cross-validation results and the final
fitted \code{spxlvb} model (\code{fit_spxlvb}). If the final fit
fails, only the CV results are returned with a warning.
}
\description{
Performs k-fold cross-validation to determine the optimal
hyperparameters and then fits a final \code{spxlvb} model to the full
dataset. When \code{b_prior_precision_grid} is supplied, a joint 2D
search over both \code{alpha_prior_precision} and
\code{b_prior_precision} is performed.
}
\details{
This function orchestrates the cross-validation process and the final model fit.
It first identifies initial values for the full dataset, uses \code{cv.spxlvb} to find
the optimal hyperparameters, and finally fits the model to the complete dataset.
}
\examples{
\donttest{
set.seed(1)
n <- 50; p <- 20
X <- matrix(rnorm(n * p), n, p)
Y <- X[, 1:3] \%*\% c(1, -1, 0.5) + rnorm(n)
fit <- cv.spxlvb.fit(k = 3, X = X, Y = Y,
  alpha_prior_precision_grid = c(100, 1000), parallel = FALSE)
}
}
\seealso{
\code{\link{cv.spxlvb}}, \code{\link{spxlvb}}
}
